<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Yandex Map Javascript API </title>
</head>

<body>
    <div class="well">
        <div id="map"></div>
        <input type="text" id="konum" placeholder="Konum" name="konum" value="" />
    </div>

    <script src="http://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="
        crossorigin="anonymous"></script>
    <script src="https://api-maps.yandex.ru/2.1/?lang=tr&amp;apikey={API_KEY}" type="text/javascript"></script>

    <style>
        .well{
            max-width: 500px;
            width:100%;
            margin:2% auto;
        }
        .well input{
            margin-top: 20px;
            width:100%; 
        }
        #map{
        height:300px;
        position: relative;
    }
</style>
    <script type="text/javascript">
        var bilgiler = [{
                'baslik': 'Konum 1',
                'konum': [39.758302083601244, 28.657235710937485],
                'resim': 'https://picsum.photos/200/300'
            },
            {
                'baslik': 'Konum 2',
                'konum': [39.764661314342, 30.50705870898432],
                'resim': 'https://picsum.photos/200/300'
            },
            {
                'baslik': 'Konum 3',
                'konum': [39.717378, 30.508432],
                'resim': 'https://picsum.photos/200/300'
            },
            {
                'baslik': 'Konum 4',
                'konum': [39.747378, 30.508432],
                'resim': 'https://picsum.photos/200/300'
            },
        ];
        var konum = $('#konum');
        ymaps.ready(init);

        function init() {
            var myPlacemark,
                myMap = new ymaps.Map('map', {
                    center: [39.777378, 30.508432], // Ben varsayılan olarak eskişehir konumunu koydum
                    zoom: 13
                }, {
                    searchControlProvider: 'yandex#search'
                });

            // eğer elinizdeki konuma bir etiket eklemek istiyorsanız
            myLastObject = new ymaps.GeoObject({
                geometry: {
                    type: "Point", // Ben nokta olarak kullanacağım dilerseniz siz farklı kullanabilirsiniz https://tech.yandex.com/maps/doc/jsapi/2.1/dg/concepts/geoobjects-docpage/
                    coordinates: [39.777378, 30.508432] // bu konuma bir 
                },
                properties: {
                    iconContent: 'Mevcut Konum',
                    hintContent: 'Sürükleyebilirsiniz'
                }
            }, {
                preset: 'islands#redStretchyIcon', // Kırmızı renkte ve içerisindeki yazıya göre uygun uzunlukta
                draggable: true // sürükleyi açıyorum 
            });

            myMap.geoObjects.add(myLastObject); // harita üzerine eski konumu ekliyorum

            // eğer elinizde bir den fazla veri varsa 
            var myCollection = new ymaps.GeoObjectCollection();
            bilgiler.forEach((item) => {
                console.log(item.konum);

                myCollection.add(new ymaps.Placemark(item.konum, {
                    iconContent: item.baslik,
                    hintContent: 'Sürükleyebilirsiniz'
                }, {
                    preset: 'islands#redStretchyIcon'
                }));

            });
            myMap.geoObjects.add(myCollection);



            // tıklama işleminde haritada ya nokta eklemek için
            myMap.events.add('click', function (e) {
                var coords = e.get('coords');
                console.log(coords); // ekrana yazdıralım
                konum.val(coords); // input a konumu atalım

                if (myPlacemark) {
                    myPlacemark.geometry.setCoordinates(coords);
                } else {
                    myPlacemark = createPlacemark(coords);
                    myMap.geoObjects.add(myPlacemark);

                    myPlacemark.events.add('dragend', function () {
                        getAddress(myPlacemark.geometry.getCoordinates());
                    });

                }
                getAddress(coords);
            });

            // Placemark oluşturalım
            function createPlacemark(coords) {
                return new ymaps.Placemark(coords, {
                    iconCaption: 'Aranıyor...'
                }, {
                    preset: 'islands#violetDotIconWithCaption',
                    draggable: true
                });
            }

            //Adresin koordinatlarla belirlenmesi
            function getAddress(coords) {
                myPlacemark.properties.set('iconCaption', 'searching...');
                ymaps.geocode(coords).then(function (res) {
                    var firstGeoObject = res.geoObjects.get(0);

                    myPlacemark.properties
                        .set({
                            iconCaption: [
                                firstGeoObject.getLocalities().length ? firstGeoObject.getLocalities() :
                                firstGeoObject.getAdministrativeAreas(),
                                firstGeoObject.getThoroughfare() || firstGeoObject.getPremise()
                            ].filter(Boolean).join(', '),
                            balloonContent: firstGeoObject.getAddressLine()
                        });
                });
            }

            // harita üzerinden scroll ile zoom yapmayı kapatmak için
            myMap.behaviors.disable('scrollZoom');
        }
    </script>
</body>

</html>